var dns = require('dns');
var retry = require('../lib/retry');

function faultTolerantResolve(address, cb) ***REMOVED***
  var opts = ***REMOVED***
    retries: 2,
    factor: 2,
    minTimeout: 1 * 1000,
    maxTimeout: 2 * 1000,
    randomize: true
***REMOVED***;
  var operation = retry.operation(opts);

  operation.attempt(function(currentAttempt) ***REMOVED***
    dns.resolve(address, function(err, addresses) ***REMOVED***
      if (operation.retry(err)) ***REMOVED***
        return;
    ***REMOVED***

      cb(operation.mainError(), operation.errors(), addresses);
  ***REMOVED***);
***REMOVED***);
}

faultTolerantResolve('nodejs.org', function(err, errors, addresses) ***REMOVED***
  console.warn('err:');
  console.log(err);

  console.warn('addresses:');
  console.log(addresses);
});