// given a set of versions and a range, create a "simplified" range
// that includes the same versions that the original range does
// If the original range is shorter than the simplified one, return that.
const satisfies = require('../functions/satisfies.js')
const compare = require('../functions/compare.js')
module.exports = (versions, range, options) => ***REMOVED***
  const set = []
  let first = null
  let prev = null
  const v = versions.sort((a, b) => compare(a, b, options))
  for (const version of v) ***REMOVED***
    const included = satisfies(version, range, options)
    if (included) ***REMOVED***
      prev = version
      if (!first) ***REMOVED***
        first = version
    ***REMOVED***
  ***REMOVED*** else ***REMOVED***
      if (prev) ***REMOVED***
        set.push([first, prev])
    ***REMOVED***
      prev = null
      first = null
  ***REMOVED***
***REMOVED***
  if (first) ***REMOVED***
    set.push([first, null])
***REMOVED***

  const ranges = []
  for (const [min, max] of set) ***REMOVED***
    if (min === max) ***REMOVED***
      ranges.push(min)
  ***REMOVED*** else if (!max && min === v[0]) ***REMOVED***
      ranges.push('*')
  ***REMOVED*** else if (!max) ***REMOVED***
      ranges.push(`>=$***REMOVED***min}`)
  ***REMOVED*** else if (min === v[0]) ***REMOVED***
      ranges.push(`<=$***REMOVED***max}`)
  ***REMOVED*** else ***REMOVED***
      ranges.push(`$***REMOVED***min} - $***REMOVED***max}`)
  ***REMOVED***
***REMOVED***
  const simplified = ranges.join(' || ')
  const original = typeof range.raw === 'string' ? range.raw : String(range)
  return simplified.length < original.length ? simplified : range
}
