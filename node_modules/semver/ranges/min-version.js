const SemVer = require('../classes/semver')
const Range = require('../classes/range')
const gt = require('../functions/gt')

const minVersion = (range, loose) => ***REMOVED***
  range = new Range(range, loose)

  let minver = new SemVer('0.0.0')
  if (range.test(minver)) ***REMOVED***
    return minver
***REMOVED***

  minver = new SemVer('0.0.0-0')
  if (range.test(minver)) ***REMOVED***
    return minver
***REMOVED***

  minver = null
  for (let i = 0; i < range.set.length; ++i) ***REMOVED***
    const comparators = range.set[i]

    let setMin = null
    comparators.forEach((comparator) => ***REMOVED***
      // Clone to avoid manipulating the comparator's semver object.
      const compver = new SemVer(comparator.semver.version)
      switch (comparator.operator) ***REMOVED***
        case '>':
          if (compver.prerelease.length === 0) ***REMOVED***
            compver.patch++
        ***REMOVED*** else ***REMOVED***
            compver.prerelease.push(0)
        ***REMOVED***
          compver.raw = compver.format()
          /* fallthrough */
        case '':
        case '>=':
          if (!setMin || gt(compver, setMin)) ***REMOVED***
            setMin = compver
        ***REMOVED***
          break
        case '<':
        case '<=':
          /* Ignore maximum versions */
          break
        /* istanbul ignore next */
        default:
          throw new Error(`Unexpected operation: $***REMOVED***comparator.operator}`)
    ***REMOVED***
  ***REMOVED***)
    if (setMin && (!minver || gt(minver, setMin))) ***REMOVED***
      minver = setMin
  ***REMOVED***
***REMOVED***

  if (minver && range.test(minver)) ***REMOVED***
    return minver
***REMOVED***

  return null
}
module.exports = minVersion
