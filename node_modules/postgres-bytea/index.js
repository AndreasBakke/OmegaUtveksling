'use strict'

module.exports = function parseBytea (input) ***REMOVED***
  if (/^\\x/.test(input)) ***REMOVED***
    // new 'hex' style response (pg >9.0)
    return new Buffer(input.substr(2), 'hex')
***REMOVED***
  var output = ''
  var i = 0
  while (i < input.length) ***REMOVED***
    if (input[i] !== '\\') ***REMOVED***
      output += input[i]
      ++i
  ***REMOVED*** else ***REMOVED***
      if (/[0-7]***REMOVED***3}/.test(input.substr(i + 1, 3))) ***REMOVED***
        output += String.fromCharCode(parseInt(input.substr(i + 1, 3), 8))
        i += 4
    ***REMOVED*** else ***REMOVED***
        var backslashes = 1
        while (i + backslashes < input.length && input[i + backslashes] === '\\') ***REMOVED***
          backslashes++
      ***REMOVED***
        for (var k = 0; k < Math.floor(backslashes / 2); ++k) ***REMOVED***
          output += '\\'
      ***REMOVED***
        i += Math.floor(backslashes / 2) * 2
    ***REMOVED***
  ***REMOVED***
***REMOVED***
  return new Buffer(output, 'binary')
}
