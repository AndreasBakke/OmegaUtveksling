/**
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import ***REMOVED*** SimpleCallbackFunction } from '../apitypes';
import ***REMOVED*** BundleDescriptor } from './bundleDescriptor';
import ***REMOVED*** Task, TaskCallback } from './task';
/**
 * Parameter to configure bundling behavior.
 * @typedef ***REMOVED***Object} BundleOptions
 * @property ***REMOVED***number} elementCountThreshold -
 *   the bundled request will be sent once the count of outstanding elements
 *   in the repeated field reaches this value.
 * @property ***REMOVED***number} elementCountLimit -
 *   represents a hard limit on the number of elements in the repeated field
 *   of the bundle; if adding a request to a bundle would exceed this value,
 *   the bundle is sent and the new request is added to a fresh bundle. It is
 *   invalid for a single request to exceed this limit.
 * @property ***REMOVED***number} requestByteThreshold -
 *   the bundled request will be sent once the count of bytes in the request
 *   reaches this value. Note that this value is pessimistically approximated
 *   by summing the bytesizes of the elements in the repeated field, and
 *   therefore may be an under-approximation.
 * @property ***REMOVED***number} requestByteLimit -
 *   represents a hard limit on the size of the bundled request; if adding
 *   a request to a bundle would exceed this value, the bundle is sent and
 *   the new request is added to a fresh bundle. It is invalid for a single
 *   request to exceed this limit. Note that this value is pessimistically
 *   approximated by summing the bytesizes of the elements in the repeated
 *   field, with a buffer applied to correspond to the resulting
 *   under-approximation.
 * @property ***REMOVED***number} delayThreshold -
 *   the bundled request will be sent this amount of time after the first
 *   element in the bundle was added to it.
 */
export interface BundleOptions ***REMOVED***
    elementCountLimit?: number;
    requestByteLimit?: number;
    elementCountThreshold?: number;
    requestByteThreshold?: number;
    delayThreshold?: number;
}
/**
 * BundleExecutor stores several timers for each bundle (calls are bundled based
 * on the options passed, each bundle has unique ID that is calculated based on
 * field values). Each timer fires and sends a call after certain amount of
 * time, and if a new request comes to the same bundle, the timer can be
 * restarted.
 */
export declare class BundleExecutor ***REMOVED***
    _options: BundleOptions;
    _descriptor: BundleDescriptor;
    _tasks: ***REMOVED***
        [index: string]: Task;
  ***REMOVED***;
    _timers: ***REMOVED***
        [index: string]: ReturnType<typeof setTimeout>;
  ***REMOVED***;
    _invocations: ***REMOVED***
        [index: string]: string;
  ***REMOVED***;
    _invocationId: number;
    /**
     * Organizes requests for an api service that requires to bundle them.
     *
     * @param ***REMOVED***BundleOptions} bundleOptions - configures strategy this instance
     *   uses when executing bundled functions.
     * @param ***REMOVED***BundleDescriptor} bundleDescriptor - the description of the bundling.
     * @constructor
     */
    constructor(bundleOptions: BundleOptions, bundleDescriptor: BundleDescriptor);
    /**
     * Schedule a method call.
     *
     * @param ***REMOVED***function} apiCall - the function for an API call.
     * @param ***REMOVED***Object} request - the request object to be bundled with others.
     * @param ***REMOVED***APICallback} callback - the callback to be called when the method finished.
     * @return ***REMOVED***function()} - the function to cancel the scheduled invocation.
     */
    schedule(apiCall: SimpleCallbackFunction, request: ***REMOVED***
        [index: string]: Array<***REMOVED***}> | string;
  ***REMOVED***, callback?: TaskCallback): import("../apitypes").GRPCCallResult;
    /**
     * Clears scheduled timeout if it exists.
     *
     * @param ***REMOVED***String} bundleId - the id for the task whose timeout needs to be
     *   cleared.
     * @private
     */
    private _maybeClearTimeout;
    /**
     * Cancels an event.
     *
     * @param ***REMOVED***String} id - The id for the event in the task.
     * @private
     */
    private _cancel;
    /**
     * Invokes a task.
     *
     * @param ***REMOVED***String} bundleId - The id for the task.
     * @private
     */
    _runNow(bundleId: string): void;
}
