import ***REMOVED*** FlattenedSign } from '../flattened/sign.js';
export class CompactSign ***REMOVED***
    constructor(payload) ***REMOVED***
        this._flattened = new FlattenedSign(payload);
  ***REMOVED***
    setProtectedHeader(protectedHeader) ***REMOVED***
        this._flattened.setProtectedHeader(protectedHeader);
        return this;
  ***REMOVED***
    async sign(key, options) ***REMOVED***
        const jws = await this._flattened.sign(key, options);
        if (jws.payload === undefined) ***REMOVED***
            throw new TypeError('use the flattened module for creating JWS with b64: false');
      ***REMOVED***
        return `$***REMOVED***jws.protected}.$***REMOVED***jws.payload}.$***REMOVED***jws.signature}`;
  ***REMOVED***
}
