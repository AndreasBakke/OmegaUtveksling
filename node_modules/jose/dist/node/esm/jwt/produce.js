import epoch from '../lib/epoch.js';
import isObject from '../lib/is_object.js';
import secs from '../lib/secs.js';
export class ProduceJWT ***REMOVED***
    constructor(payload) ***REMOVED***
        if (!isObject(payload)) ***REMOVED***
            throw new TypeError('JWT Claims Set MUST be an object');
      ***REMOVED***
        this._payload = payload;
  ***REMOVED***
    setIssuer(issuer) ***REMOVED***
        this._payload = ***REMOVED*** ...this._payload, iss: issuer };
        return this;
  ***REMOVED***
    setSubject(subject) ***REMOVED***
        this._payload = ***REMOVED*** ...this._payload, sub: subject };
        return this;
  ***REMOVED***
    setAudience(audience) ***REMOVED***
        this._payload = ***REMOVED*** ...this._payload, aud: audience };
        return this;
  ***REMOVED***
    setJti(jwtId) ***REMOVED***
        this._payload = ***REMOVED*** ...this._payload, jti: jwtId };
        return this;
  ***REMOVED***
    setNotBefore(input) ***REMOVED***
        if (typeof input === 'number') ***REMOVED***
            this._payload = ***REMOVED*** ...this._payload, nbf: input };
      ***REMOVED***
        else ***REMOVED***
            this._payload = ***REMOVED*** ...this._payload, nbf: epoch(new Date()) + secs(input) };
      ***REMOVED***
        return this;
  ***REMOVED***
    setExpirationTime(input) ***REMOVED***
        if (typeof input === 'number') ***REMOVED***
            this._payload = ***REMOVED*** ...this._payload, exp: input };
      ***REMOVED***
        else ***REMOVED***
            this._payload = ***REMOVED*** ...this._payload, exp: epoch(new Date()) + secs(input) };
      ***REMOVED***
        return this;
  ***REMOVED***
    setIssuedAt(input) ***REMOVED***
        if (typeof input === 'undefined') ***REMOVED***
            this._payload = ***REMOVED*** ...this._payload, iat: epoch(new Date()) };
      ***REMOVED***
        else ***REMOVED***
            this._payload = ***REMOVED*** ...this._payload, iat: input };
      ***REMOVED***
        return this;
  ***REMOVED***
}
