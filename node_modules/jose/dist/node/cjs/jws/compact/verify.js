"use strict";
Object.defineProperty(exports, "__esModule", ***REMOVED*** value: true });
exports.compactVerify = void 0;
const verify_js_1 = require("../flattened/verify.js");
const errors_js_1 = require("../../util/errors.js");
const buffer_utils_js_1 = require("../../lib/buffer_utils.js");
async function compactVerify(jws, key, options) ***REMOVED***
    if (jws instanceof Uint8Array) ***REMOVED***
        jws = buffer_utils_js_1.decoder.decode(jws);
  ***REMOVED***
    if (typeof jws !== 'string') ***REMOVED***
        throw new errors_js_1.JWSInvalid('Compact JWS must be a string or Uint8Array');
  ***REMOVED***
    const ***REMOVED*** 0: protectedHeader, 1: payload, 2: signature, length } = jws.split('.');
    if (length !== 3) ***REMOVED***
        throw new errors_js_1.JWSInvalid('Invalid Compact JWS');
  ***REMOVED***
    const verified = await (0, verify_js_1.flattenedVerify)(***REMOVED*** payload, protected: protectedHeader, signature }, key, options);
    const result = ***REMOVED*** payload: verified.payload, protectedHeader: verified.protectedHeader };
    if (typeof key === 'function') ***REMOVED***
        return ***REMOVED*** ...result, key: verified.key };
  ***REMOVED***
    return result;
}
exports.compactVerify = compactVerify;
