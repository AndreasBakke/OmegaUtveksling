"use strict";
Object.defineProperty(exports, "__esModule", ***REMOVED*** value: true });
exports.generalVerify = void 0;
const verify_js_1 = require("../flattened/verify.js");
const errors_js_1 = require("../../util/errors.js");
const is_object_js_1 = require("../../lib/is_object.js");
async function generalVerify(jws, key, options) ***REMOVED***
    if (!(0, is_object_js_1.default)(jws)) ***REMOVED***
        throw new errors_js_1.JWSInvalid('General JWS must be an object');
  ***REMOVED***
    if (!Array.isArray(jws.signatures) || !jws.signatures.every(is_object_js_1.default)) ***REMOVED***
        throw new errors_js_1.JWSInvalid('JWS Signatures missing or incorrect type');
  ***REMOVED***
    for (const signature of jws.signatures) ***REMOVED***
        try ***REMOVED***
            return await (0, verify_js_1.flattenedVerify)(***REMOVED***
                header: signature.header,
                payload: jws.payload,
                protected: signature.protected,
                signature: signature.signature,
          ***REMOVED***, key, options);
      ***REMOVED***
        catch ***REMOVED***
      ***REMOVED***
  ***REMOVED***
    throw new errors_js_1.JWSSignatureVerificationFailed();
}
exports.generalVerify = generalVerify;
