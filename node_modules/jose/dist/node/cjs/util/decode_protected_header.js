"use strict";
Object.defineProperty(exports, "__esModule", ***REMOVED*** value: true });
exports.decodeProtectedHeader = void 0;
const base64url_js_1 = require("./base64url.js");
const buffer_utils_js_1 = require("../lib/buffer_utils.js");
const is_object_js_1 = require("../lib/is_object.js");
function decodeProtectedHeader(token) ***REMOVED***
    let protectedB64u;
    if (typeof token === 'string') ***REMOVED***
        const parts = token.split('.');
        if (parts.length === 3 || parts.length === 5) ***REMOVED***
            ;
            [protectedB64u] = parts;
      ***REMOVED***
  ***REMOVED***
    else if (typeof token === 'object' && token) ***REMOVED***
        if ('protected' in token) ***REMOVED***
            protectedB64u = token.protected;
      ***REMOVED***
        else ***REMOVED***
            throw new TypeError('Token does not contain a Protected Header');
      ***REMOVED***
  ***REMOVED***
    try ***REMOVED***
        if (typeof protectedB64u !== 'string' || !protectedB64u) ***REMOVED***
            throw new Error();
      ***REMOVED***
        const result = JSON.parse(buffer_utils_js_1.decoder.decode((0, base64url_js_1.decode)(protectedB64u)));
        if (!(0, is_object_js_1.default)(result)) ***REMOVED***
            throw new Error();
      ***REMOVED***
        return result;
  ***REMOVED***
    catch ***REMOVED***
        throw new TypeError('Invalid Token or Protected Header formatting');
  ***REMOVED***
}
exports.decodeProtectedHeader = decodeProtectedHeader;
