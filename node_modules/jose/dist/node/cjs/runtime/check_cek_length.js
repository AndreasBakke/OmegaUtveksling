"use strict";
Object.defineProperty(exports, "__esModule", ***REMOVED*** value: true });
const errors_js_1 = require("../util/errors.js");
const is_key_object_js_1 = require("./is_key_object.js");
const checkCekLength = (enc, cek) => ***REMOVED***
    let expected;
    switch (enc) ***REMOVED***
        case 'A128CBC-HS256':
        case 'A192CBC-HS384':
        case 'A256CBC-HS512':
            expected = parseInt(enc.slice(-3), 10);
            break;
        case 'A128GCM':
        case 'A192GCM':
        case 'A256GCM':
            expected = parseInt(enc.slice(1, 4), 10);
            break;
        default:
            throw new errors_js_1.JOSENotSupported(`Content Encryption Algorithm $***REMOVED***enc} is not supported either by JOSE or your javascript runtime`);
  ***REMOVED***
    if (cek instanceof Uint8Array) ***REMOVED***
        const actual = cek.byteLength << 3;
        if (actual !== expected) ***REMOVED***
            throw new errors_js_1.JWEInvalid(`Invalid Content Encryption Key length. Expected $***REMOVED***expected} bits, got $***REMOVED***actual} bits`);
      ***REMOVED***
        return;
  ***REMOVED***
    if ((0, is_key_object_js_1.default)(cek) && cek.type === 'secret') ***REMOVED***
        const actual = cek.symmetricKeySize << 3;
        if (actual !== expected) ***REMOVED***
            throw new errors_js_1.JWEInvalid(`Invalid Content Encryption Key length. Expected $***REMOVED***expected} bits, got $***REMOVED***actual} bits`);
      ***REMOVED***
        return;
  ***REMOVED***
    throw new TypeError('Invalid Content Encryption Key type');
};
exports.default = checkCekLength;
