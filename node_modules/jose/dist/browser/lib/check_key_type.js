import ***REMOVED*** withAlg as invalidKeyInput } from './invalid_key_input.js';
import isKeyLike, ***REMOVED*** types } from '../runtime/is_key_like.js';
const symmetricTypeCheck = (alg, key) => ***REMOVED***
    if (key instanceof Uint8Array)
        return;
    if (!isKeyLike(key)) ***REMOVED***
        throw new TypeError(invalidKeyInput(alg, key, ...types, 'Uint8Array'));
  ***REMOVED***
    if (key.type !== 'secret') ***REMOVED***
        throw new TypeError(`$***REMOVED***types.join(' or ')} instances for symmetric algorithms must be of type "secret"`);
  ***REMOVED***
};
const asymmetricTypeCheck = (alg, key, usage) => ***REMOVED***
    if (!isKeyLike(key)) ***REMOVED***
        throw new TypeError(invalidKeyInput(alg, key, ...types));
  ***REMOVED***
    if (key.type === 'secret') ***REMOVED***
        throw new TypeError(`$***REMOVED***types.join(' or ')} instances for asymmetric algorithms must not be of type "secret"`);
  ***REMOVED***
    if (usage === 'sign' && key.type === 'public') ***REMOVED***
        throw new TypeError(`$***REMOVED***types.join(' or ')} instances for asymmetric algorithm signing must be of type "private"`);
  ***REMOVED***
    if (usage === 'decrypt' && key.type === 'public') ***REMOVED***
        throw new TypeError(`$***REMOVED***types.join(' or ')} instances for asymmetric algorithm decryption must be of type "private"`);
  ***REMOVED***
    if (key.algorithm && usage === 'verify' && key.type === 'private') ***REMOVED***
        throw new TypeError(`$***REMOVED***types.join(' or ')} instances for asymmetric algorithm verifying must be of type "public"`);
  ***REMOVED***
    if (key.algorithm && usage === 'encrypt' && key.type === 'private') ***REMOVED***
        throw new TypeError(`$***REMOVED***types.join(' or ')} instances for asymmetric algorithm encryption must be of type "public"`);
  ***REMOVED***
};
const checkKeyType = (alg, key, usage) => ***REMOVED***
    const symmetric = alg.startsWith('HS') ||
        alg === 'dir' ||
        alg.startsWith('PBES2') ||
        /^A\d***REMOVED***3}(?:GCM)?KW$/.test(alg);
    if (symmetric) ***REMOVED***
        symmetricTypeCheck(alg, key);
  ***REMOVED***
    else ***REMOVED***
        asymmetricTypeCheck(alg, key, usage);
  ***REMOVED***
};
export default checkKeyType;
