import ***REMOVED*** importJWK } from '../key/import.js';
import isObject from '../lib/is_object.js';
import ***REMOVED*** JWSInvalid } from '../util/errors.js';
export async function EmbeddedJWK(protectedHeader, token) ***REMOVED***
    const joseHeader = ***REMOVED***
        ...protectedHeader,
        ...token.header,
  ***REMOVED***;
    if (!isObject(joseHeader.jwk)) ***REMOVED***
        throw new JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');
  ***REMOVED***
    const key = await importJWK(***REMOVED*** ...joseHeader.jwk, ext: true }, joseHeader.alg, true);
    if (key instanceof Uint8Array || key.type !== 'public') ***REMOVED***
        throw new JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');
  ***REMOVED***
    return key;
}
