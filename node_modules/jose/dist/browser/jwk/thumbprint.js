import digest from '../runtime/digest.js';
import ***REMOVED*** encode as base64url } from '../runtime/base64url.js';
import ***REMOVED*** JOSENotSupported, JWKInvalid } from '../util/errors.js';
import ***REMOVED*** encoder } from '../lib/buffer_utils.js';
import isObject from '../lib/is_object.js';
const check = (value, description) => ***REMOVED***
    if (typeof value !== 'string' || !value) ***REMOVED***
        throw new JWKInvalid(`$***REMOVED***description} missing or invalid`);
  ***REMOVED***
};
export async function calculateJwkThumbprint(jwk, digestAlgorithm) ***REMOVED***
    if (!isObject(jwk)) ***REMOVED***
        throw new TypeError('JWK must be an object');
  ***REMOVED***
    digestAlgorithm !== null && digestAlgorithm !== void 0 ? digestAlgorithm : (digestAlgorithm = 'sha256');
    if (digestAlgorithm !== 'sha256' &&
        digestAlgorithm !== 'sha384' &&
        digestAlgorithm !== 'sha512') ***REMOVED***
        throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');
  ***REMOVED***
    let components;
    switch (jwk.kty) ***REMOVED***
        case 'EC':
            check(jwk.crv, '"crv" (Curve) Parameter');
            check(jwk.x, '"x" (X Coordinate) Parameter');
            check(jwk.y, '"y" (Y Coordinate) Parameter');
            components = ***REMOVED*** crv: jwk.crv, kty: jwk.kty, x: jwk.x, y: jwk.y };
            break;
        case 'OKP':
            check(jwk.crv, '"crv" (Subtype of Key Pair) Parameter');
            check(jwk.x, '"x" (Public Key) Parameter');
            components = ***REMOVED*** crv: jwk.crv, kty: jwk.kty, x: jwk.x };
            break;
        case 'RSA':
            check(jwk.e, '"e" (Exponent) Parameter');
            check(jwk.n, '"n" (Modulus) Parameter');
            components = ***REMOVED*** e: jwk.e, kty: jwk.kty, n: jwk.n };
            break;
        case 'oct':
            check(jwk.k, '"k" (Key Value) Parameter');
            components = ***REMOVED*** k: jwk.k, kty: jwk.kty };
            break;
        default:
            throw new JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported');
  ***REMOVED***
    const data = encoder.encode(JSON.stringify(components));
    return base64url(await digest(digestAlgorithm, data));
}
export async function calculateJwkThumbprintUri(jwk, digestAlgorithm) ***REMOVED***
    digestAlgorithm !== null && digestAlgorithm !== void 0 ? digestAlgorithm : (digestAlgorithm = 'sha256');
    const thumbprint = await calculateJwkThumbprint(jwk, digestAlgorithm);
    return `urn:ietf:params:oauth:jwk-thumbprint:sha-$***REMOVED***digestAlgorithm.slice(-3)}:$***REMOVED***thumbprint}`;
}
