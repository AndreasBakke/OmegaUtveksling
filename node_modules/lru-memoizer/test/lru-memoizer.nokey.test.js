var memoizer = require('./..');
var assert = require('chai').assert;

describe('lru-memoizer (no key)', function () ***REMOVED***
  var loadTimes = 0, memoized;

  beforeEach(function () ***REMOVED***
    loadTimes = 0;

    memoized = memoizer(***REMOVED***
      load: function (callback) ***REMOVED***
        loadTimes++;
        return setTimeout(function () ***REMOVED***
          callback(null, loadTimes);
      ***REMOVED***, 10);
    ***REMOVED***
  ***REMOVED***);
***REMOVED***);

  it('should cache the result of an async function', function (done) ***REMOVED***
    memoized(function (err, result) ***REMOVED***
      assert.isNull(err);
      assert.equal(result, 1);
      assert.equal(loadTimes, 1);
      memoized(function (err, result) ***REMOVED***
        assert.isNull(err);
        assert.equal(result, 1);
        assert.equal(loadTimes, 1);
        done();
    ***REMOVED***);
  ***REMOVED***);

***REMOVED***);

  it('should use the hash function for keys', function (done) ***REMOVED***
    memoized(function () ***REMOVED***
      memoized(function () ***REMOVED***
        assert.includeMembers(memoized.keys(), ['_']);
        done();
    ***REMOVED***);
  ***REMOVED***);
***REMOVED***);
});
