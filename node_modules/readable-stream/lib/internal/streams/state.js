'use strict';

var ERR_INVALID_OPT_VALUE = require('../../../errors').codes.ERR_INVALID_OPT_VALUE;

function highWaterMarkFrom(options, isDuplex, duplexKey) ***REMOVED***
  return options.highWaterMark != null ? options.highWaterMark : isDuplex ? options[duplexKey] : null;
}

function getHighWaterMark(state, options, duplexKey, isDuplex) ***REMOVED***
  var hwm = highWaterMarkFrom(options, isDuplex, duplexKey);

  if (hwm != null) ***REMOVED***
    if (!(isFinite(hwm) && Math.floor(hwm) === hwm) || hwm < 0) ***REMOVED***
      var name = isDuplex ? duplexKey : 'highWaterMark';
      throw new ERR_INVALID_OPT_VALUE(name, hwm);
  ***REMOVED***

    return Math.floor(hwm);
***REMOVED*** // Default value


  return state.objectMode ? 16 : 16 * 1024;
}

module.exports = ***REMOVED***
  getHighWaterMark: getHighWaterMark
};