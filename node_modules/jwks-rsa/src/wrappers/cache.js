const logger = require('debug')('jwks');
const memoizer = require('lru-memoizer');
const ***REMOVED*** promisify, callbackify } = require('util');

function cacheWrapper(client, ***REMOVED*** cacheMaxEntries = 5, cacheMaxAge = 600000 }) ***REMOVED***
  logger(`Configured caching of signing keys. Max: $***REMOVED***cacheMaxEntries} / Age: $***REMOVED***cacheMaxAge}`);
  return promisify(memoizer(***REMOVED***
    hash: (kid) => kid,
    load: callbackify(client.getSigningKey.bind(client)),
    maxAge: cacheMaxAge,
    max: cacheMaxEntries
***REMOVED***));
}

module.exports.default = cacheWrapper;
